<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Jonathan</title>
	<link rel="stylesheet" href="./src/style/screen.template.css">
	<link rel="stylesheet" href="../src/fontawesome/css/all.css">

	<script src="https://code.jquery.com/jquery-3.7.1.min.js"
		integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
	<script src="./script.js"></script>
	<script type="text/javascript" src="https://livejs.com/live.js"></script>
	<link rel="icon" type="image/png" size="16x16" href="../src/img/favicon.svg">
</head>

<body class="saRootBody saLargeScreen saPc saCompact">
	<button type="button" class="saGoBack"><i class="saIcon far fa-arrow-left"></i></button>
	<div class="saAuthContainer">
		<div class="saAuthWrapper">
			<img src="../src/img/softadmin-logo-minimized.svg" alt="Logo" class="saLogo" width="64" height="64">
			<h1 class="saAuthTitle">Kolla din email</h1>
			<div class="saAuthText">
				<p>Vi har skickat en kod till din email.</p>
				<p>Ange koden nedan för att fortsätta.</p>
			</div>
			<fieldset class="saAuth">
				<input type="text" maxlength="1" inputmode="numeric" placeholder="" autocomplete="one-time-code" aria-label="Code digit 1 of 6" tabindex="-1" pattern="[0-9]*" autofocus >
				<input type="text" maxlength="1" inputmode="numeric" placeholder="" autocomplete="off" aria-label="Code digit 2 of 6" tabindex="-1" pattern="[0-9]*">
				<input type="text" maxlength="1" inputmode="numeric" placeholder="" autocomplete="off" aria-label="Code digit 3 of 6" tabindex="-1" pattern="[0-9]*">
				<input type="text" maxlength="1" inputmode="numeric" placeholder="" autocomplete="off" aria-label="Code digit 4 of 6" tabindex="-1" pattern="[0-9]*">
				<input type="text" maxlength="1" inputmode="numeric" placeholder="" autocomplete="off" aria-label="Code digit 5 of 6" tabindex="-1" pattern="[0-9]*">
				<input type="text" maxlength="1" inputmode="numeric" placeholder="" autocomplete="off" aria-label="Code digit 6 of 6" tabindex="-1" pattern="[0-9]*">
			</fieldset>
			<a class="saAuthLink" href="#">Skicka koden igen</a>
		</div>
	</div>
</body>

<script>
	$(document).ready(function () {
		const $inputs = $('.saAuth input');

		// Update tabindex: only one input at a time gets tabindex="0"
		function updateTabindex(activeIndex) {
			$inputs.attr('tabindex', -1);
			if (activeIndex >= 0 && activeIndex < $inputs.length) {
				$inputs.eq(activeIndex).attr('tabindex', 0).focus();
			}
		}

		$inputs.on('input', function (e) {
			const $this = $(this);
			const val = $this.val();
			const index = $inputs.index(this);
			// If multiple characters entered (paste), distribute them
			if (val.length > 1) {
				const chars = val.replace(/\D/g, '').split('');
				for (let i = 0; i < chars.length && (index + i) < $inputs.length; i++) {
					$inputs.eq(index + i).val(chars[i]);
				}
				// Clear any remaining inputs after the pasted chars
				for (let i = index + chars.length; i < $inputs.length; i++) {
					$inputs.eq(i).val('');
				}
				const nextIndex = Math.min(index + chars.length, $inputs.length - 1);
				updateTabindex(nextIndex);
				return;
			}

			// Only move forward if a digit was entered
			if (val.match(/[0-9]/) && index < $inputs.length - 1) {
				updateTabindex(index + 1);
			}
		});

		$inputs.on('keydown', function (e) {
			const index = $inputs.index(this);

			if (e.key === 'Backspace') {
				if (!$(this).val() && index > 0) {
					updateTabindex(index - 1);
				}
			}
		});

		// Initialize: focus first input with tabindex 0
		updateTabindex($inputs.index($inputs.filter('[tabindex="0"]')));

	});
</script>

</html>