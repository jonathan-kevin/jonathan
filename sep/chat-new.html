<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Jonathan</title>
	<link rel="stylesheet" href="./src/style/screen.template.css">
	<link rel="stylesheet" href="../src/fontawesome/css/all.css">
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"
		integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
	<script src="./script.js"></script>
	<script type="text/javascript" src="https://livejs.com/live.js"></script>
	<link rel="icon" type="image/png" size="16x16" href="../src/img/favicon.svg">
</head>

<body class="saRootBody saLargeScreen saPc saCompact">
	<div class="saRootContentWrapper">
		<div class="saSideBar saSideBarJs saExpanded">
			<form id="aspnetForm">
				<nav id="SideBar">
					<div class="saPageHeader saSmallScreenHeader">
						<div class="saHeader">
							<div class="saTopRow">
								<button class="saNavigator" type="button">
									<div class="saNavBar saActive"><span class="saNavBarStripe"></span>
										<span class="saNavBarStripe"></span>
										<span class="saNavBarStripe"></span>
									</div>
								</button>
								<div class="saHeaderWrapper">
									<div class="saTitle">
										<h1>Softadmin® Utvecklingssystem</h1>
									</div>
								</div>
								<button class="saNotificationWrapper" type="button">
									<div><i class="far fa-bell saIcon"></i></div>
									<div class="saNotificationBadge saEmpty" aria-hidden="true">
										<div class="saNotificationBadgeCount">0</div>
									</div>
								</button>
							</div>
						</div>
					</div>
					<div class="saSidenav" id="sidenav">
						<div class="saSidenavSection">
							<div class="saCustomerLogo">
								<div>
									<img loading="lazy" src="../src/img/logo.svg" alt="Softadmin® logo"
										style="min-height: 5rem;">
								</div>
							</div>
							<div class="saSidenavContainer">
								<div class="saSidenavItem saMenuDropdownsOuter">
									<div class="saSidenavItemWrapper">
										<label class="saInputTextWrapper saLabeled">
											<span class="saLabeledLabel">User</span>
											<span class="saFirstLetter">J</span>
											<select class="saInputText saDropdown">
												<option value="0" selected="true">Jonathan</option>
												<option value="1">Kevin</option>
											</select>
											<div class="saTrailingIconsWrapper">
												<i class="saIcon far fa-angle-down"></i>
											</div>
										</label>
									</div>
								</div>
								<div class="saToggleGroup" role="tablist" aria-label="Toggle menu/favorites">
									<button class="saDynamicTooltipJs" type="button" id="tabbutton1" role="tab"
										aria-selected="true">
										<i class="saIcon far fa-bars" aria-hidden="true"></i>
										<span class="saToggleText">Menu</span>
									</button>
									<button class="saDynamicTooltipJs" type="button" id="tabbutton2" role="tab">
										<i class="saIcon far fa-star" aria-hidden="true"></i>
										<span class="saToggleText">Favorites</span>
									</button>
								</div>
							</div>
							<div class="saSidenavLists">
								<ul class="saSidenavItemList">
									<li>
										<a class="saSidenavItemWrapper" tabindex="0">
											<div class="saSidenavItem">
												<i class="far fa-crow saIcon"></i>
												<span class="saSidenavItemText">Crow</span>
											</div>
										</a>
									</li>
									<li>
										<a class="saSidenavItemWrapper" tabindex="0">
											<div class="saSidenavItem">
												<i class="far fa-arrow-turn-down-left saIcon"></i>
												<span class="saSidenavItemText">Egg</span>
											</div>
										</a>
									</li>
									<li>
										<a class="saSidenavItemWrapper" tabindex="0">
											<div class="saSidenavItem">
												<i class="far fa-feather saIcon"></i>
												<span class="saSidenavItemText">Flying lessons</span>
											</div>
										</a>
									</li>
									<li>
										<a class="saSidenavItemWrapper" tabindex="0">
											<div class="saSidenavItem">
												<i class="far fa-ticket-alt saIcon"></i>
												<span class="saSidenavItemText">Aviary tickets</span>
											</div>
										</a>
									</li>
								</ul>
							</div>
						</div>
						<div class="saSidenavSection saSidenavSectionLast">
							<div class="saSidenavContainer">
								<div class="saListItem">
									<button class="saSidenavItemWrapper" type="button" aria-expanded="false">
										<div class="saSidenavItem saAvatarWrapperOuter">
											<div class="saAvatarWrapper saUserInitials" aria-hidden="true">JK</div>
											<span class="saSidenavItemText">Jonathan Kevin</span><i
												class="far fa-angle-down saIcon"></i>
										</div>
									</button>
								</div>
								<div class="saSidenavItem saSidenavItemRow">
									<button class="saSidenavItemWrapper" type="button">
										<div class="saSidenavItem">
											<i class="far fa-gear icon saIcon"></i>
											<span class="saSidenavItemText">Admin</span>
										</div>
									</button>
									<button class="saSidenavItemWrapper" type="button">
										<div class="saSidenavItem">
											<i class="far fa-person-limbs-wide icon saIcon"></i>
											<span class="saSidenavItemText">Database designer</span>
										</div>
									</button>
									<button class="saSidenavItemWrapper" type="button">
										<div class="saSidenavItem">
											<i class="far fa-window-restore icon saIcon"></i>
											<span class="saSidenavItemText">Ny flik</span>
										</div>
									</button>
									<button class="saSidenavItemWrapper" type="button">
										<div class="saSidenavItem">
											<i class="far fa-circle-question icon saIcon"></i>
											<span class="saSidenavItemText">Visa hjälpsida - Allmän hjälpsida</span>
										</div>
									</button>
									<button class="saSidenavItemWrapper saNotificationLinkLargeScreen" type="button">
										<div class="saSidenavItem">
											<div><i class="far fa-bell saIcon"></i></div>
											<span class="saSidenavItemText">Notifieringar</span>
										</div>
										<div class="saNotificationBadge saEmpty" aria-hidden="true">
											<div class="saNotificationBadgeCount">0</div>
										</div>
									</button>
								</div>
							</div>
							<div class="saSidenavFooter">
								<a class="saSoftadminLogo" rel="noopener noreferrer" tabindex="-1" href="#">
									<img loading="lazy" class="saLogo" src="../src/img/softadmin-logo-minimized.svg">
									<img loading="lazy" class="saWordmark" src="../src/img/softadmin-logo-expanded.svg">
								</a>
								<button class="saExpander saDynamicTooltipJs" type="button">
									<i class="fa-angles-left far saIcon"></i>
								</button>
							</div>
						</div>
					</div>
				</nav>
			</form>
		</div>
		<div class="saRightFrameRoot">
			<div class="right standardview">
				<div class="pagecontentframe">
					<form class="interface">
						<header id="pageheader" class="saPageHeaderHolder">
							<div class="saPageHeader saDesktopHeader">
								<div class="saHeader">
									<div class="saRowWrapper">
										<div class="saTopRow">
											<nav class="saBreadcrumbs">
												<div class="saBackButtonWrapper">
													<button class="saBackButton" type="button" disabled>
														<i class="fa-arrow-left far saBack saIcon"></i>
													</button>
												</div>
											</nav>
										</div>
										<div class="saBottomRow">
											<div class="saTitle">
												<h1 class="saHeaderText">Test</h1>
												<div class="saMarkFavorite saNoSpinner"><button type="button"><i
															class="fas fa-star saFavoriteIcon saFavoriteAdded icon saIcon"></i></button>
												</div>
												<ul class="saSpecialLinksWrapper"></ul>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="saPageHeader saSmallScreenHeader">
								<div class="saHeader">
									<div class="saHeaderInner">
										<div class="saTopRow">
											<div class="saHeaderWrapper">
												<div class="saTitle">
													<h1 class="saHeaderText">Test</h1>
												</div>
											</div>
											<button class="saNavigator" type="button">
												<div class="saNavBar"><span class="saNavBarStripe"></span><span
														class="saNavBarStripe"></span><span
														class="saNavBarStripe"></span>
												</div>
											</button>
											<button class="saNotificationWrapper" type="button" aria-live="polite">
												<div><i class="far fa-bell saIcon"></i></div>
												<div class="saNotificationBadge saEmpty" aria-hidden="true">
													<div class="saNotificationBadgeCount">0</div>
												</div>
											</button>
										</div>
									</div>
									<nav class="saBottomRow saActionLinkBar" style="display: none;"></nav>
								</div>
							</div>
						</header>
						<div class="maincolinner gradients">
							<main id="MI_M" class="menuitem pagecontentframe">
								<div id="MI_ScrollIndicator" class="scrollindicator"></div>
								<div id="MI_ScrollContent" class="scrollcontent saScrollable">
									<div class="scrollcontent-inner">
										<div class="saChatWrapper">
											<div class="saChat">
												<ol class="saLog" aria-role="log" aria-relevant="additions" id="chatLog"
													aria-label="The Chat">
													<li role="separator" class="saChatDate">
														<time datetime="2025-10-08">Yesterday</time>
													</li>
													<li class="saMessage">
														<div title="Olivia Rydén" class="saChatAvatar saPink">JM</div>
														<article class="saMessageInner">
															<div class="saMessageBody">
																<p>Wings UP team! As we navigate through our tasks today.</p>
																<p>Wings UP team! As we navigate through our tasks today.</p>
																<p>Wings UP team! As we navigate through our tasks today.</p>
															</div>
															<footer class="saMessageFooter">
																<div class="saSenderName">Jessica Mås</div>
																<time class="saMessageTime" datetime="2026-01-12T12:15:12+02:00" aria-label="Sent at 11:00">11:01</time>
															</footer>
														</article>
													</li>

													<li class="saMessage">

														<img loading="lazy" title="Stefan Stefan" class="saChatAvatar" src="https://untitledui.com/images/avatars/loki-bright">
														<div class="saMessageInner">
															<div class="saMessageBody">
																<p>With unity and determination, there's no limit to what we can achieve!</p>
															</div>
															<footer class="saMessageFooter">
																<div class="saSenderName">Erik Öster</div>
																<time class="saMessageTime" datetime="2026-01-12T12:15:12+02:00" aria-label="Sent at 08:11">08:11</time>
															</footer>
														</div>
													</li>
													<li class="saMessage saSender">
														<article class="saMessageInner">
															<div class="saMessageBody">
																<p>today?</p>
																<p>or?</p>
																<p>tomorrow?</p>
															</div>
															<footer class="saMessageFooter">
																<time class="saMessageTime"
																	datetime="2026-01-12T12:15:12+02:00"
																	aria-label="Sent at 11:00">11:01</time>
															</footer>
														</article>
													</li>

													<li class="saMessage saSender">
														<article class="saMessageInner">
															<div class="saMessageBody">
																<p>today?</p>
															</div>
														</article>
													</li>
													<li class="saResponse">
														<article>
															<p>Sure,</p>
															<p>Let's make sure we're on track to resolve it efficiently.
																Also,
																it's time we discuss the bird bill of sale. I'll be
																available
																for a meeting later today to go over the details. Looking
																forward to hearing from everyone!</p>
														</article>
														<ul class="saChatToolbar" role="toolbar" aria-label="Message actions">
															<li>
																<button type="button" title="Copy message" aria-label="Copy message">
																	<i class="far fa-copy saIcon"></i>
																</button>
															</li>
															<li>
																<button type="button" title="Redo" aria-label="Try again">
																	<i class="far fa-arrow-rotate-right saIcon"></i>
																</button>
															</li>
															<li>
																<button type="button" title="Crow" aria-label="Crow">
																	<i class="far fa-crow saIcon"></i>
																</button>
															</li>
														</ul>
													</li>
													<li role="separator" class="saChatDate">
														<time datetime="2025-10-08">Today</time>
													</li>
													<li class="saResponse">
														<article>
															<p>Sure,</p>
															<p>Let's make sure we're on track to resolve it efficiently. Also, it's time we discuss the bird bill of sale. I'll be available for a meeting later today to go over the details. Looking forward to hearing from everyone!</p>
														</article>
														<ul class="saChatToolbar" role="toolbar" aria-label="Message actions">
															<li>
																<button type="button" title="Copy message" aria-label="Copy message">
																	<i class="far fa-copy saIcon"></i>
																</button>
															</li>
															<li>
																<button type="button" title="Redo" aria-label="Try again">
																	<i class="far fa-arrow-rotate-right saIcon"></i>
																</button>
															</li>
															<li>
																<button type="button" title="Crow" aria-label="Crow">
																	<i class="far fa-crow saIcon"></i>
																</button>
															</li>
														</ul>
													</li>
													<li class="saChatLoading" id="loading" role="separator">
														<div class="saDot"></div>
														<div class="saDot"></div>
														<div class="saDot"></div>
													</li>
												</ol>
												<a class="saChatLatest saReached" id="latest" href="#" aria-label="Scroll to latest messages">
													<i class="far fa-arrow-down"></i>
												</a>
											</div>
											<div class="saComposer" id="composer">
												<textarea name="message" placeholder="Write your message..." id="prompt" enterkeyhint="send"></textarea>
												<button type="submit" class="saButtonSend" id="send" disabled
													aria-label="Send prompt" title="Send prompt">
													<i class="fa-arrow-up saIcon far"></i>
												</button>
												<button type="button" class="saButtonStop" id="stop"
													aria-label="Stop response" title="Stop prompt"
													style="display: none;">
													<i class="fa-stop saIcon fas"></i>
												</button>
											</div>
											<p class="saComposerInstruction">Check my work. I'm not well.</p>
										</div>
									</div>
								</div>
							</main>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>
</body>
<script>
 $(document).ready(function () {
    // Chat application module
    const ChatApp = (function () {
        // DOM elements
        const $prompt = $('#prompt');
        const $composer = $('#composer');
        const $chatLog = $('#chatLog');
        const $latest = $('#latest');
        const $send = $('#send');
        const $stop = $('#stop');
        const $loader = $('#loading');

        // State management
        let state = 'idle'; // idle | thinking
        let responseTimeout = null;

        // Create toolbar for messages
        function createToolbar(isPrompt) {
            const $toolbar = $('<ul>')
                .attr({
                    'role': 'toolbar',
                    'aria-label': 'Message actions'
                })
                .addClass('saChatToolbar');

            const buttons = isPrompt
                ? [
                    { label: 'Edit message', icon: 'pen' },
                    { label: 'Copy message', icon: 'copy' }
                ]
                : [
                    { label: 'Copy message', icon: 'copy' },
                    { label: 'Try again', icon: 'arrow-rotate-right' },
                    { label: 'Crow', icon: 'bird-crow' }
                ];

            buttons.forEach(({ label, icon }) => {
                $toolbar.append(
                    $('<li>').append(
                        $('<button>')
                            .attr({
                                'type': 'button',
                                'aria-label': label
                            })
                            .append($('<i>').addClass(`far fa-${icon} saIcon`))
                    )
                );
            });

            return $toolbar;
        }

        // Update send button state
        function updateSendButton() {
            $send.prop('disabled', !$prompt.val().trim());
        }

        // Manage sparkles animation
        function setLoading(show) {
            $loader
                .toggle(show)
                .attr('aria-busy', show ? 'true' : null);
        }

        // Update chat state
        function setState(newState) {
            state = newState;
            const isThinking = state === 'thinking';

            $send.toggle(!isThinking);
            $stop.toggle(isThinking);

            if (!isThinking) {
                updateSendButton();
            }
        }

        // Send and handle message
        function sendMessage() {
            const message = $prompt.val().trim();
            if (!message || state !== 'idle') return;

            // Add user prompt to chat log
            const lines = message.split(/\r?\n/);
            const $promptLi = $('<li>')
                .addClass('saPrompt')
                .append(
                    $('<p>').html(lines.map(line => $('<div>').text(line).html()).join('<br>')),
                    createToolbar(true)
                );
            $chatLog.append($promptLi);

            // Reset input
            $prompt.val('');
            updateSendButton();
            $prompt.focus();
            scrollToBottom();

            // Set thinking state
            setState('thinking');

            // Simulate response with word-by-word reveal
            const responseLines = [
                "Absolutely, I can help you with that.",
                "Here are the steps you should follow:",
                "1. Review the requirements.",
                "2. Implement the necessary changes.",
                "3. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua."
            ];

            const $responseLi = $('<li>').addClass('saResponse');
            $chatLog.append($responseLi);

            // Split response into words and track paragraph boundaries
            const words = responseLines.join(' ').split(/\s+/);
            const lineWordCounts = responseLines.map(line => line.split(/\s+/).length);
            let wordIndex = 0;
            let currentLineIndex = 0;
            let wordsInCurrentLine = 0;
            let currentP = $('<p>').appendTo($responseLi);

            function revealWord() {
                if (wordIndex < words.length) {
                    if (wordIndex > 0 && wordsInCurrentLine === 0) {
                        currentP = $('<p>').appendTo($responseLi); // Start new paragraph
                    } else if (wordIndex > 0) {
                        currentP.append(' ');
                    }
                    currentP.append($('<span>').text(words[wordIndex]).addClass('saWord'));
                    scrollToBottom();
                    wordIndex++;
                    wordsInCurrentLine++;

                    // Check if current paragraph is complete
                    if (wordsInCurrentLine >= lineWordCounts[currentLineIndex]) {
                        // Replace spans with paragraph text
                        currentP.html($('<div>').text(responseLines[currentLineIndex]).html());
                        currentLineIndex++;
                        wordsInCurrentLine = 0;
                    }

                    responseTimeout = setTimeout(revealWord, 25); // Adjust delay (25ms per word)
                } else {
                    $responseLi.append(createToolbar(false));
                    scrollToBottom();
                    setState('idle');
                }
            }

            // Remove loader and start revealing words after a short delay
            setLoading(false); // Loader removed at response start
            setTimeout(revealWord, 1000);

            // Handle stop button
            $stop.off('click').on('click', function () {
                clearTimeout(responseTimeout);
                // Replace all content with final paragraphs
                const finalHtml = responseLines.map(line => $('<p>').text(line).prop('outerHTML')).join('');
                $responseLi.html(finalHtml);
                $responseLi.append(createToolbar(false));
                setState('idle');
            });
        }

		// Enhanced scroll handler for chat day/date pills and lines
		function enhancedHandleScroll() {
			// Mark visible messages as read (if you have such logic)
			// messageHandler.markVisibleAsRead();

			// For each chat day separator
			$(".saChatDate").each(function (index) {
				const $current = $(this);
				const $pill = $current.find('time');
				const $next = $(".saChatDate").eq(index + 1);

				if ($next.length) {
					const distance = $next.offset().top - $current.offset().top;
					// Scale effect
					if (distance <= 100) {
						const scale = Math.max(0, distance / 100).toFixed(2);
						$pill.css("transform", `scale(${scale <= 0.1 ? 0 : scale})`);
					} else {
						$pill.css("transform", "scale(1)");
					}
					// Opacity effect
					if (distance <= 50) {
						const opacity = Math.max(0, distance / 50).toFixed(2);
						$pill.css("opacity", opacity <= 0.1 ? 0 : opacity);
					} else {
						$pill.css("opacity", "1");
					}
				}
			});
		}

        // Scroll chat log to bottom
        function scrollToBottom() {
            $chatLog[0].scrollTop = $chatLog[0].scrollHeight;
        }

        // Handle scroll events
        function handleScroll() {
            const isAtBottom = Math.abs(
                $chatLog[0].scrollHeight - $chatLog[0].scrollTop - $chatLog[0].clientHeight
            ) < 16;
            $latest.toggleClass('saReached', isAtBottom);
			 enhancedHandleScroll();
        }

        // Initialize event listeners
        function initEvents() {
            $prompt.on('input', function () {
                if (state === 'idle') updateSendButton();
            });

            $send.on('click', function (e) {
                e.preventDefault();
                sendMessage();
            });

            $prompt.on('keydown', function (e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            $stop.on('click', function () {
                clearTimeout(responseTimeout);
                setState('idle');
            });

            $chatLog.on('scroll', handleScroll);
        }

        // Initialize the chat application
        function init() {
            initEvents();
            updateSendButton();
        }

        return { init };
    })();

    // Start the application
    ChatApp.init();
});
</script>

</html>