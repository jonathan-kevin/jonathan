<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Slider</title>
	<link rel="stylesheet" href="./src/style/screen.template.css">
	<link rel="stylesheet" href="./src/fontawesome/css/all.css">
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"
		integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
	<script src="./script.js"></script>
	<style>
		.saLabel {
			font-size: 14px;
			line-height: 16px;
			font-weight: 500;
		}

		.saDescription {
			font-size: 14px;
			line-height: 16px;
			font-weight: 300;
			color: #506072;
		}
	</style>
</head>

<body>

	<main style="padding: 16px; display: flex; align-items: flex-start; height: fit-content;">

		<div class="slider-container" id="multi-slider"></div>

	</main>
	<script>
		$(document).ready(function () {
			$(function () {
				function createSlider(container, handles) {
					let $container = $(container);
					$container.empty();

					let sliders = [];
					let inputsHtml = '<div class="inputs">';

					for (let i = 0; i < handles; i++) {
						let $slider = $(`<input type="range" min="0" max="100" value="${20 + i * 20}" step="1" class="range-slider" data-handle="${i}">`);
						sliders.push($slider);
						$container.append($slider);
						inputsHtml += `<input type="number" id="input-${i}" min="0" max="100">`;
					}
					inputsHtml += '</div>';
					$container.append(inputsHtml);

					let labels = sliders.map(() => $('<div class="thumb-label"></div>').appendTo($container));

					function updateBackground() {
						let values = sliders.map(s => parseInt(s.val())).sort((a, b) => a - b);

						// Ensure values are in proper order
						for (let i = 0; i < values.length - 1; i++) {
							if (values[i] > values[i + 1]) {
								[values[i], values[i + 1]] = [values[i + 1], values[i]];
							}
						}

						let gradient = `linear-gradient(to right, gray ${values[0]}%, gray ${values[0]}%, blue ${values[0]}%, blue ${values[1]}%, gray ${values[1]}%, gray ${values[2]}%, blue ${values[2]}%, blue ${values[3]}%, gray ${values[3]}%, gray 100%)`;
						sliders[0].css('background', gradient);
					}

					sliders.forEach(($slider, i) => {
						let $input = $(`#input-${i}`);
						let $label = labels[i];

						function update() {
							let val = $slider.val();
							$input.val(val);
							$label.text(val).css('left', ($slider.position().left + ($slider.width() * val / 100)) + 'px');
							updateBackground();
						}

						$slider.on('input change', update);
						$input.on('input', function () {
							let val = parseFloat($input.val());
							if (!isNaN(val) && val >= 0 && val <= 100) {
								$slider.val(val).trigger('input');
							}
						});

						update();
					});
				}

				createSlider('#multi-slider', 4);
			});
		});

	</script>
</body>

</html>